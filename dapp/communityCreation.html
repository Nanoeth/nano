<script type="text/javascript" src="abi.js" ></script>
<script type="text/javascript" src="util.js" ></script>
<script type="text/javascript">

function deployCommunity () {
    var result = document.getElementById('result')
    result.innerHtml = 'Deploying community ...'
    var link = document.getElementById('link')
    link.style.display = 'none'
    link.innerHTML = ''
 var community_sol_community = communityContract().new(
   {
     from: web3.eth.accounts[0], 
     data: '0x6060604052341561000c57fe5b5b610015610071565b809050604051809103906000f080151561002b57fe5b600060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505b610081565b6040516102b58061131c83390190565b61128c806100906000396000f3006060604052361561008c576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff1680631d6476051461008e57806351b74f99146100b2578063597435cb1461011657806369f9d91c146101605780637e166297146101eb5780638137c7aa14610235578063b03357c514610247578063c3f909d414610281575bfe5b341561009657fe5b6100b06004808035600019169060200190919050506102d3565b005b34156100ba57fe5b6100d46004808035600019169060200190919050506104fd565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b341561011e57fe5b61014a600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091905050610530565b6040518082815260200191505060405180910390f35b341561016857fe5b610194600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091905050610613565b604051808573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200184815260200183815260200182815260200194505050505060405180910390f35b34156101f357fe5b61021f600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091905050610663565b6040518082815260200191505060405180910390f35b341561023d57fe5b610245610686565b005b341561024f57fe5b61027f60048080356000191690602001909190803560001916906020019091908035906020019091905050610918565b005b341561028957fe5b61029161101d565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b6102db611221565b33816000019073ffffffffffffffffffffffffffffffffffffffff16908173ffffffffffffffffffffffffffffffffffffffff168152505060008160200181815250506000816040018181525050600081606001818152505080600160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008201518160000160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055506020820151816001015560408201518160020155606082015181600301559050503360026000846000191660001916815260200190815260200160002060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055503360026000846000191660001916815260200190815260200160002060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055507ff616b7b7499a4605cc97dc9b7a0fd5cf3df886e0068da2e4d2a127855e7c7bd160405180806020018281038252600f8152602001807f63726561746557616c6c6574206f6b000000000000000000000000000000000081525060200191505060405180910390a15b5050565b60026020528060005260406000206000915054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b600061053a611221565b61054383611048565b9050600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663b38119fd82602001518360600151436000604051602001526040518463ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808481526020018381526020018281526020019350505050602060405180830381600087803b15156105f357fe5b60325a03f1151561060057fe5b5050506040518051905091505b50919050565b60016020528060005260406000206000915090508060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16908060010154908060020154908060030154905084565b600061066d611221565b61067683611048565b9050806060015191505b50919050565b600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16635fc0c1e56000604051602001526040518163ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401809050602060405180830381600087803b151561071457fe5b60325a03f1151561072157fe5b50505060405180519050600160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600201544303111561091557600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166314d2de886000604051602001526040518163ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401809050602060405180830381600087803b151561080457fe5b60325a03f1151561081157fe5b50505060405180519050600160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206001018190555043600160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600301819055507ff616b7b7499a4605cc97dc9b7a0fd5cf3df886e0068da2e4d2a127855e7c7bd16040518080602001828103825260108152602001807f72657175657374526566696c6c206f6b0000000000000000000000000000000081525060200191505060405180910390a1610916565b5b565b610920611221565b610928611221565b60006000600060006000871115156109a7577ff616b7b7499a4605cc97dc9b7a0fd5cf3df886e0068da2e4d2a127855e7c7bd16040518080602001828103825260148152602001807f6e6f2076616c7565206f72206e6567617469766500000000000000000000000081525060200191505060405180910390a1611012565b6109b088611117565b9550600073ffffffffffffffffffffffffffffffffffffffff16866000015173ffffffffffffffffffffffffffffffffffffffff161415610a58577ff616b7b7499a4605cc97dc9b7a0fd5cf3df886e0068da2e4d2a127855e7c7bd16040518080602001828103825260108152602001807f73656e646572206e6f7420666f756e640000000000000000000000000000000081525060200191505060405180910390a1611012565b610a6189611117565b9450600073ffffffffffffffffffffffffffffffffffffffff16856000015173ffffffffffffffffffffffffffffffffffffffff161415610b09577ff616b7b7499a4605cc97dc9b7a0fd5cf3df886e0068da2e4d2a127855e7c7bd16040518080602001828103825260128152602001807f7265636569766572206e6f7420666f756e64000000000000000000000000000081525060200191505060405180910390a1611012565b600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663b38119fd86602001518760600151436000604051602001526040518463ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808481526020018381526020018281526020019350505050602060405180830381600087803b1515610bb757fe5b60325a03f11515610bc457fe5b505050604051805190509350600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663b38119fd87602001518860600151436000604051602001526040518463ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808481526020018381526020018281526020019350505050602060405180830381600087803b1515610c7e57fe5b60325a03f11515610c8b57fe5b50505060405180519050925083871115610d0c577ff616b7b7499a4605cc97dc9b7a0fd5cf3df886e0068da2e4d2a127855e7c7bd16040518080602001828103825260128152602001807f6e6f7420656e6f7567682062616c616e6365000000000000000000000000000081525060200191505060405180910390a1611012565b86840360016000876000015173ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206001018190555086830160016000886000015173ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206001018190555085606001519150600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16635fc0c1e56000604051602001526040518163ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401809050602060405180830381600087803b1515610e3b57fe5b60325a03f11515610e4857fe5b50505060405180519050824303101515610eac574360016000886000015173ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060030181905550610fa9565b600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663aee376e3886000604051602001526040518263ffffffff167c010000000000000000000000000000000000000000000000000000000002815260040180828152602001915050602060405180830381600087803b1515610f4257fe5b60325a03f11515610f4f57fe5b50505060405180519050905080820160016000886000015173ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600301819055505b7ff616b7b7499a4605cc97dc9b7a0fd5cf3df886e0068da2e4d2a127855e7c7bd16040518080602001828103825260078152602001807f73656e64206f6b0000000000000000000000000000000000000000000000000081525060200191505060405180910390a15b505050505050505050565b6000600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1690505b90565b611050611221565b600160008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020608060405190810160405290816000820160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001600182015481526020016002820154815260200160038201548152505090505b919050565b61111f611221565b6001600060026000856000191660001916815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020608060405190810160405290816000820160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001600182015481526020016002820154815260200160038201548152505090505b919050565b608060405190810160405280600073ffffffffffffffffffffffffffffffffffffffff16815260200160008152602001600081526020016000815250905600a165627a7a723058202d7e494824cc1304bbbac35de36538e08e9346a6ecabdc748bcee38cd315efb60029606060405261012c60005561012c6001556101f4600255341561001e57fe5b5b6102878061002e6000396000f30060606040523615610076576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff16806314d2de88146100785780633cd5a6721461009e5780635fc0c1e5146100be578063a165ab2c146100e4578063aee376e314610104578063b38119fd14610138575bfe5b341561008057fe5b61008861017e565b6040518082815260200191505060405180910390f35b34156100a657fe5b6100bc6004808035906020019091905050610189565b005b34156100c657fe5b6100ce610194565b6040518082815260200191505060405180910390f35b34156100ec57fe5b610102600480803590602001909190505061019f565b005b341561010c57fe5b61012260048080359060200190919050506101aa565b6040518082815260200191505060405180910390f35b341561014057fe5b61016860048080359060200190919080359060200190919080359060200190919050506101e0565b6040518082815260200191505060405180910390f35b600060025490505b90565b806000819055505b50565b600060005490505b90565b806002819055505b50565b6000600254821015156101c15760005490506101db565b6002546000548115156101d057fe5b04820290506101db565b5b919050565b6000600060005484840311156101f95760009150610253565b6001546000540384840311151561021257849150610253565b6103e860015460005486860303010290506001548181151561023057fe5b049050806103e80390506103e885820281151561024957fe5b049150610253565b5b5b5093925050505600a165627a7a723058208f2ca23f0f323e14885662522a639a388f04164ec3f95b5b348fee6cff15f9430029',
     gas: gasLimit 
    }, function (error, contract) {        
        if (!error) {
            result.innerHTML = 'waiting for ' + contract.transactionHash + ' ...'
            tryTillResponse(contract.transactionHash, function (error, tx) {
                result.innerHTML = 'Community Deployed at ' + tx.contractAddress
                link.style.display = 'block'
                link.setAttribute('href', 'walletCreation.html?community=' + tx.contractAddress)
                link.innerHTML = 'go to wallet creation'
            })       
        } 
        else {
            result.innerHTML = error
        }     
 })   
}
</script>

<div>Community Creation:</div>
<div id='communityCreation'>
    <button id="deploycommunitybtn" onclick="deployCommunity()">Deploy Community</button>
</div>
<div id="result"></div>
<a href="" id="link" style="display:none">Wallet Creation</a>
</div>
